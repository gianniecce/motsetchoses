{
    "contents" : "---\nlayout: post\ntitle:  \"Data Format\"\ncategories: [jekyll]\ntags: [mtus]\n---\n\n\n<span class='newthought'>This post</span> will discuss the 3 most common data format in Time Use: \n\n1. Short Person-Persion (\"Spells\") format \n2. Long Person-Persion (\"Spells\") format \n3. State sequences (Wide) format \n\n\n#### Load the libraries and data \n\n```{r, warning=FALSE, message=FALSE}\nlibrary(plyr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(mtusRlocal)\nlibrary(knitr)\nlibrary(reshape2)\nlibrary(xtable)\n\nlibrary('schoolmath')\n\ndta = read.csv('/Users/giacomovagni/site/motsetchoses/_data/dtaSpells.csv')\n```\n\n```{r, results='asis', echo=FALSE}\nkable(dta, align = 'c') \n```\n\n```{r} \ndtaPP = dta[rep(1:nrow(dta), dta$duration), ] %>% \n  select(-duration) %>% \n  group_by(id, day) %>% \n  mutate( Time = 1:n())\n```\n\nLet's look at the first 10 entries \n\n```{r, results='asis', echo=FALSE}\nkable(dtaPP [1:10, ], align = 'c') \n```\n\nThe maximum time per day is \n```{r}\ndtaPP %>% group_by(id, day) %>% summarise(max(Time))\n```\n\nwhich means that we have created a one minute interval dataset, known as **Long Person-Period**: \n\nThis code enables to transform the long file into a **Wide Sequence** file. \n```{r}\ndtaWide = dtaPP %>% select(-epnum) %>% spread(Time, activities)\n```\n\nThe 10 first sequence episodes look like this : \n\n```{r, results='asis', echo=FALSE}\nkable( dtaWide [, 1:12] , align = 'c') \n```\n\n\n## Change the interval time \n\nFind the greatest common divisor \n\n```{r}\nl = length(dta$duration) \nv = array(0, l)\n\nfor(i in 2:l){\n  v[i] = gcd(dta$duration[i], dta$duration[i-1]) \n}\n\nminV = min(v[-1]) \nminV\ndta$duration = dta$duration / minV\n```\n\n```{r}\ndtaPP = dta[rep(1:nrow(dta), dta$duration), ] %>% \n  select(-duration) %>% \n  group_by(id, day) %>% \n  mutate( Time = 1:n())\n```\n\nThe new Long Person Period file has now `72` episodes, which is equals to `1440` when multiplied by `20` \n\n```{r}\ndtaPP %>% group_by(id, day) %>% summarise(max(Time))\n\n72 * 20\n```\n\n\n\n",
    "created" : 1458743192134.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4280071186",
    "id" : "79661F74",
    "lastKnownWriteTime" : 1458750070,
    "path" : "~/site/motsetchoses/_source/2016-03-23-format.Rmd",
    "project_path" : "_source/2016-03-23-format.Rmd",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_markdown"
}