# Weighted mean
dtaSeq %>% select(idind, day, day_weights, matches('main')) %>%
melt(id.vars = c("idind", "day", "day_weights")) %>%
group_by(idind, day, day_weights, value) %>%
summarise(n = n()) %>%
mutate(value = paste('act_', value, sep = '')) %>%
spread(value, n, fill = 0) %>%
summarise(meanTV = mean(act_TV), weightedmean = weighted.mean(act_TV, day_weights))
```
dta %>% count(day, wt = weekendproba)
weekendproba
dta %>% count(day, wt = day_weights)
dtaSeq %>% count(day, wt = day_weights)
dtaSeq
dtaSeq %>% count(day, wt = day_weights)
dtaSeq %>% count(day, wt = day_weights) %>% mutate(n / sum(n))
dtaSeq %>% count(day) %>% mutate(n = n / sum(n))
dtaSeq %>% count(day) %>% mutate(n = n / sum(n))
dtaSeq %>% count(day, wt = day_weights) %>% mutate(n = n / sum(n))
dtaSeq %>% count(day) %>% mutate(n = n / sum(n))
dtaSeq %>% count(day) %>% mutate(n = n / sum(n))
dtaSeq %>% count(day, wt = day_weights) %>% mutate(p = n / sum(n))
dtaSeq %>% count(day) %>% mutate(p = n / sum(n))
dtaSeq %>% count(day, wt = day_weights) %>% mutate(p = n / sum(n))
servr::jekyll(command = '/Users/giacomovagni/.rvm/gems/ruby-2.2.1/wrappers/jekyll build')
---
layout: post
title:  "Compute mean for activities - all format"
categories: [jekyll]
tags: [mtus]
---
<span class='newthought'>This post</span> will demonstrate how to simply calcualte mean time of different activities for different format.
```{r, warning=FALSE, message=FALSE}
# Load the libraries and data
library(plyr)
library(dplyr)
library(tidyr)
library(mtusRlocal)
library(knitr)
library(reshape2)
library(xtable)
dta = read.csv('/Users/giacomovagni/site/motsetchoses/_data/dtaSpells.csv')
```
### 1. Mean of Short PP file
The `sum` of all activites duration for each individuals for a day must be **1440**.
```{r}
dta %>% group_by(id, day) %>% summarise(sum(duration))
```
The individual mean can be computed such as :
```{r}
dta %>% group_by(id, activities) %>% summarise(mean(duration))
```
The aggregate mean by day :
```{r}
dta %>% group_by(day, activities) %>% summarise(mean(duration))
```
The aggregate mean by activities, regardless of the day :
```{r}
dta %>% group_by(activities) %>% summarise(mean(duration))
```
### 2. Mean of Long PP file
For Long PP file
```{r}
# transform
dtaPP= dta[rep(1:nrow(dta), dta$duration), ] %>%
select(-duration) %>%
group_by(id, day) %>%
mutate(Time = 1:n())
dtaPP %>% group_by(id, day, activities) %>% summarise(time = n()) %>% # transform back to short PP
group_by(activities, day) %>%
summarise(mean(time))
```
### 3. Mean of Sequence File
#### 3.1. Aggregate
The mean time of activities for long PP can be computed by the following codes :
```{r}
# transform PP to Wide
dtaSeq = dta[rep(1:nrow(dta), dta$duration), ] %>%
select(-duration) %>%
group_by(id, day) %>%
mutate(Time = 1:n()) %>% # PP
arrange(id, day, Time) %>% select(-epnum) %>% spread(Time, activities) # Wide
# colnames renames
colnames(dtaSeq) = c('idind', 'day', paste("main", 1:1440, sep = ""))
```
dtaSeq
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day"))
summarise(n = sum(value) * 1)
dtaSeq
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
summarise(n = sum(value) * 1)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day"))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day"))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n())
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
mutate(time =  mean (n* 1) )
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
summarise(time =  mean (n* 1) )
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
summarise(time =  mean (n* 1) ) %>% # divide by count
mutate(TimeClock(time))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value) %>%
summarise(n = n()) %>% # back to PP
mutate(time =  (n* 1) / 4 ) %>% # divide by count
mutate(TimeClock(time))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
mutate(time =  (n* 1) / 4)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n())
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
mutate(time =  mean(n) )
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
mutate(time =  (n* 1) / 4 ) %>% # divide by count
mutate(TimeClock(time))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
mutate(time =  mean(n) )
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day)
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n())
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(idind, value, day)
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(idind, value, day) %>%
summarise(n = n())
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(idind, value, day) %>%
summarise(n = n()) %>% # back to PP
mutate(time =  mean(n))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
mutate(time =  (n* 1) / 4 ) %>% # divide by count
mutate(TimeClock(time))
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
mutate(time =  mean(n))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n())
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n())
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n())
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
mutate(time =  mean(n))
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n())
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
group_by(value) %>%
mutate(time =  mean(n))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
mutate(time =  (n* 1) / 4 ) %>% # divide by count
mutate(TimeClock(time))
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
group_by(value) %>%
mutate(time =  mean(n))
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
group_by(value) %>%
mutate(time =  mean(n)) %>% # divide by count
mutate(TimeClock(time))
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
mutate(time =  (n* 1) / 4 )
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
group_by(value)
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
group_by() %>%
mutate(time =  mean(n))
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
group_by(value) %>%
mutate(time =  mean(n))
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
group_by(value)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
count(value, day)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
count(value, day)
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
count(value, day)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day"))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% head()
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
summarise(n = sum(value) * 1)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(day) %>%
summarise(n = sum(value) * 1)
# if dummy variables
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(day) %>%
summarise(n = sum(value) * 1) %>%
summarise(meanN = weighted.mean(n)) %>% mutate(meanN = TimeClock(meanN)) %>% spread(survey, meanN)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(day) %>%
summarise(n = sum(value) * 1) %>%
summarise(meanN = weighted.mean(n))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(day) %>%
summarise(n = sum(value) * 1)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
mutate(time =  (n* 1) / 4 ) %>% # divide by count
mutate(TimeClock(time))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(day)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(day) %>%
summarise(n = sum(value) * 1
)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(day) %>%
summarise(n = sum(value) * 1) %>%
summarise(meanN = weighted.mean(n))
# if dummy variables
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(day) %>%
summarise(n = sum(value) * 1) %>%
summarise(meanN = mean(n))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(idind)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
count(idind)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(idind) %>% mutate(n_distinct(idind))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(idind) %>% mutate(max(n_distinct(idind)))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(idind) %>% mutate(sum(n_distinct(idind)))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(idind) %>% summarise(n_distinct(idind))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% summarise(n_distinct(idind))
# if dummy variables
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% summarise(nid = n_distinct(idind))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% mutate(nid = n_distinct(idind))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% mutate(nid = n_distinct(idind))
group_by(day) %>%
summarise(n = sum(value) * 1)
# if dummy variables
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% mutate(nid = n_distinct(idind))
group_by(day)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% mutate(nid = n_distinct(idind)) %>%
group_by(day)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% mutate(nid = n_distinct(idind)) %>%
group_by(day) %>%
summarise(n = sum(value) * 1)
# if dummy variables
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% mutate(nid = n_distinct(idind)) %>%
group_by(day) %>%
summarise(n = sum(value) * 1) %>%
summarise(meanN = n / nid)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% mutate(nid = n_distinct(idind)) %>%
group_by(day)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% mutate(nid = n_distinct(idind)) %>%
group_by(day) %>%
summarise(n = sum(value) * 1)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% mutate(nid = n_distinct(idind)) %>%
group_by(nid, day) %>%
summarise(n = sum(value) * 1)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% mutate(nid = n_distinct(idind)) %>%
group_by(nid, day) %>%
summarise(n = sum(value) * 1) %>%
summarise(meanN = n / nid)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% mutate(nid = n_distinct(idind)) %>%
group_by(nid, day) %>%
summarise(n = sum(value) * 1) %>%
mutate(meanN = n / nid)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% mutate(nid = n_distinct(idind)) %>%
group_by(nid, day) %>%
summarise(n = sum(value) * 1) %>%
mutate(meanN = n / nid) %>% mutate(meanN = TimeClock(meanN)) %>% spread(survey, meanN)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% mutate(nid = n_distinct(idind)) %>%
group_by(nid, day) %>%
summarise(n = sum(value) * 1) %>%
mutate(meanN = n / nid) %>% mutate(meanN = TimeClock(meanN))
# by act only
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>% group_by(value, day) %>%
summarise(n = n()) %>% # back to PP
mutate(time =  (n* 1) / 4 ) %>% # divide by count
mutate(TimeClock(time))
# if dummy variables
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% mutate(nid = n_distinct(idind)) %>%
group_by(nid, day) %>%
summarise(n = sum(value) * 1) %>%
mutate(meanN = n / nid) %>% mutate(meanN = TimeClock(meanN))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(day) %>% mutate(nid = n_distinct(idind))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
count(day, idind)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
count(idind, day)
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(idind, day)
# if dummy variables
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(idind, day) %>% summarise(n())
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(idind, day) %>% summarise(n_distinct(n))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(idind, day) %>% summarise(n_distinct(idind))
# if dummy variables
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(idind, day) %>% summarise(n_distinct(day))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(idind, day) %>% summarise(n_distinct(idind))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(day) %>% summarise(n_distinct(idind))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(day) %>% summarise(nid = sum( n_distinct(idind)))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by() %>% summarise(nid = sum( n_distinct(idind)))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(day) %>% summarise(nid = sum( n_distinct(idind)))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(day) %>% summarise(nid = n_distinct(idind))
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(idind, day) %>% summarise(count())
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(idind, day) %>% count()
dtaSeq %>% select(idind, day, matches('main')) %>%
melt(id.vars = c("idind", "day")) %>%
mutate(value = ifelse(value == 'sleep', 1, 0)) %>%
group_by(idind, day) %>% summarise(n())
