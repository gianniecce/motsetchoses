---
layout: post
title:  "Retrieve Days and Dates in R"
categories: [jekyll, rstats]
tags: [knitr, servr, httpuv, websocket]
---

In this post, we will see how to handle dates in `R`. 

Copy-paste the following lines of codes with the dataset. 

```{r}
# the data 
dta = structure(list(id = c("1001893912015", "1001893912015", "10067992412015", 
"10067992412015", "10079545612015", "10079545612015", "10079545622015", 
"10079545622015", "1012460812015", "1012460812015"), age = c(36, 
36, 54, 54, 60, 60, 22, 22, 30, 30), DiaryDay = c(13615862400, 
13616035200, 13617504000, 13617849600, 13619664000, 13619923200, 
13619664000, 13619923200, 13633574400, 13633833600)), .Names = c("id", 
"age", "DiaryDay"), row.names = c(NA, 10L), class = "data.frame")
```

Let's have a look at it 

```{r}
head(dta) 
```

We can see that there is 3 variables in this dataset - a personal identifier `id`, the age and the `DiaryDay`. Diary day is the vector of interest where the date as been stored. 

There exist an international standard for dates. As explained 

> "The purpose of this standard is to provide an unambiguous and well-defined method of representing dates and times."  

[][https://en.wikipedia.org/wiki/ISO_8601] 


This dataset as been imported from `SPSS` and as a special `origin`. In order to get the dates right, we have to indicate what is the origin that the software as taken. 

In order to retreive dates in R, we use the function `as.Dates`. 
Looking at the documentation, we find that 
> Matlab's origin is 719529 days before ours 

However, nothing is specified for `SPSS`. After a bit of research, we found that SPSS takes as origin `1582-10-14` [here][http://www.uic.edu/depts/accc/software/isodates/datepgm.html]. 

The Uni of York propose then a simply command 

```{r}
spss2date <- function(x) as.Date(x/86400, origin = "1582-10-14")
```

They divided by `86400` because they transform "turn seconds into days" [MathYork][http://scs.math.yorku.ca/index.php/R:_Importing_dates_from_SPSS]. 


Let us try 
```{r}
dta$DiaryDayConverted = spss2date(dta$DiaryDay)
```

We get 

```{r}
dta 
```

Now we want to retreive the days of the week. 

In order to do so, we need to use the library `lubridate`. In this library, you will find the function `wday`. 

```{r}
library(lubridate)
dta$weekdayvar = wday(dta$DiaryDayConverted, label = T) 
dta
```



